{"ast":null,"code":"import React,{useState}from'react';import'../../styles/Admin.css';import API_BASE_URL from'../../config/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function MediaUploader(_ref){let{itemId,onUploadSuccess,onUploadComplete}=_ref;const[uploading,setUploading]=useState(false);const[error,setError]=useState('');const[dragActive,setDragActive]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const validateFile=file=>{const maxSize=50*1024*1024;// 50MB\nconst allowedTypes=['image/jpeg','image/jpg','image/png','image/webp','video/mp4','model/gltf-binary','application/octet-stream'// GLB files\n];if(file.size>maxSize){return'File size must be less than 50MB';}if(!allowedTypes.includes(file.type)&&!file.name.toLowerCase().endsWith('.glb')){return'File type not supported. Please use JPEG, PNG, WebP, MP4, or GLB files.';}return null;};const handleFileUpload=async file=>{console.log('Starting file upload:',file.name,'to item:',itemId);// Validate file\nconst validationError=validateFile(file);if(validationError){setError(validationError);return;}setUploading(true);setError('');setUploadProgress(0);const formData=new FormData();formData.append('media',file);formData.append('alt',file.name);try{console.log('Sending request to:',\"\".concat(API_BASE_URL,\"/api/admin/portfolio/\").concat(itemId,\"/media\"));const response=await fetch(\"\".concat(API_BASE_URL,\"/api/admin/portfolio/\").concat(itemId,\"/media\"),{method:'POST',credentials:'include',body:formData});console.log('Response status:',response.status);const data=await response.json();console.log('Response data:',data);if(response.ok){setUploadProgress(100);// Call the success callback instead of reloading\nif(onUploadSuccess){onUploadSuccess(data.media);}// Call the complete callback to refetch media\nif(onUploadComplete){onUploadComplete();}setError('');// Clear any previous errors\nconsole.log('Upload successful');// Reset progress after a short delay\nsetTimeout(()=>{setUploadProgress(0);},1000);}else{setError(data.error||'Upload failed');console.error('Upload failed:',data.error);}}catch(error){console.error('Upload error:',error);setError('Network error');}finally{setUploading(false);}};const handleFileSelect=e=>{const file=e.target.files[0];if(file){handleFileUpload(file);}};const handleDrag=e=>{e.preventDefault();e.stopPropagation();if(e.type==='dragenter'||e.type==='dragover'){setDragActive(true);}else if(e.type==='dragleave'){setDragActive(false);}};const handleDrop=e=>{e.preventDefault();e.stopPropagation();setDragActive(false);const file=e.dataTransfer.files[0];if(file){handleFileUpload(file);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"media-uploader\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"upload-area \".concat(dragActive?'drag-active':''),onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:handleDrop,children:/*#__PURE__*/_jsxs(\"div\",{className:\"upload-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"upload-icon\",children:\"\\uD83D\\uDCC1\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Upload Media\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Drag and drop files here, or click to select\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*,video/*,.glb\",onChange:handleFileSelect,disabled:uploading,style:{display:'none'},id:\"media-upload\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"media-upload\",className:\"upload-button\",children:uploading?'Uploading...':'Choose File'}),uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"upload-progress\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:\"\".concat(uploadProgress,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{children:[uploadProgress,\"%\"]})]})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Supported file types:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Images: JPEG, PNG, WebP\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Videos: MP4\"}),/*#__PURE__*/_jsx(\"li\",{children:\"3D Models: GLB\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Maximum file size: 50MB\"})]})]});}export default MediaUploader;","map":{"version":3,"names":["React","useState","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","MediaUploader","_ref","itemId","onUploadSuccess","onUploadComplete","uploading","setUploading","error","setError","dragActive","setDragActive","uploadProgress","setUploadProgress","validateFile","file","maxSize","allowedTypes","size","includes","type","name","toLowerCase","endsWith","handleFileUpload","console","log","validationError","formData","FormData","append","concat","response","fetch","method","credentials","body","status","data","json","ok","media","setTimeout","handleFileSelect","e","target","files","handleDrag","preventDefault","stopPropagation","handleDrop","dataTransfer","className","children","onDragEnter","onDragLeave","onDragOver","onDrop","accept","onChange","disabled","style","display","id","htmlFor","width"],"sources":["C:/Users/jacka/OneDrive/Documents/GitHub/test/round2MERN/pstudios/pstudios-landingpage/src/admin/portfolio/MediaUploader.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport '../../styles/Admin.css';\r\nimport API_BASE_URL from '../../config/api';\r\n\r\nfunction MediaUploader({ itemId, onUploadSuccess, onUploadComplete }) {\r\n  const [uploading, setUploading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [dragActive, setDragActive] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n\r\n  const validateFile = (file) => {\r\n    const maxSize = 50 * 1024 * 1024; // 50MB\r\n    const allowedTypes = [\r\n      'image/jpeg', 'image/jpg', 'image/png', 'image/webp',\r\n      'video/mp4',\r\n      'model/gltf-binary', 'application/octet-stream' // GLB files\r\n    ];\r\n    \r\n    if (file.size > maxSize) {\r\n      return 'File size must be less than 50MB';\r\n    }\r\n    \r\n    if (!allowedTypes.includes(file.type) && !file.name.toLowerCase().endsWith('.glb')) {\r\n      return 'File type not supported. Please use JPEG, PNG, WebP, MP4, or GLB files.';\r\n    }\r\n    \r\n    return null;\r\n  };\r\n\r\n  const handleFileUpload = async (file) => {\r\n    console.log('Starting file upload:', file.name, 'to item:', itemId);\r\n    \r\n    // Validate file\r\n    const validationError = validateFile(file);\r\n    if (validationError) {\r\n      setError(validationError);\r\n      return;\r\n    }\r\n    \r\n    setUploading(true);\r\n    setError('');\r\n    setUploadProgress(0);\r\n\r\n    const formData = new FormData();\r\n    formData.append('media', file);\r\n    formData.append('alt', file.name);\r\n\r\n    try {\r\n      console.log('Sending request to:', `${API_BASE_URL}/api/admin/portfolio/${itemId}/media`);\r\n      const response = await fetch(`${API_BASE_URL}/api/admin/portfolio/${itemId}/media`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        body: formData,\r\n      });\r\n\r\n      console.log('Response status:', response.status);\r\n      const data = await response.json();\r\n      console.log('Response data:', data);\r\n\r\n      if (response.ok) {\r\n        setUploadProgress(100);\r\n        // Call the success callback instead of reloading\r\n        if (onUploadSuccess) {\r\n          onUploadSuccess(data.media);\r\n        }\r\n        // Call the complete callback to refetch media\r\n        if (onUploadComplete) {\r\n          onUploadComplete();\r\n        }\r\n        setError(''); // Clear any previous errors\r\n        console.log('Upload successful');\r\n        // Reset progress after a short delay\r\n        setTimeout(() => {\r\n          setUploadProgress(0);\r\n        }, 1000);\r\n      } else {\r\n        setError(data.error || 'Upload failed');\r\n        console.error('Upload failed:', data.error);\r\n      }\r\n    } catch (error) {\r\n      console.error('Upload error:', error);\r\n      setError('Network error');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      handleFileUpload(file);\r\n    }\r\n  };\r\n\r\n  const handleDrag = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.type === 'dragenter' || e.type === 'dragover') {\r\n      setDragActive(true);\r\n    } else if (e.type === 'dragleave') {\r\n      setDragActive(false);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n\r\n    const file = e.dataTransfer.files[0];\r\n    if (file) {\r\n      handleFileUpload(file);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"media-uploader\">\r\n      <div\r\n        className={`upload-area ${dragActive ? 'drag-active' : ''}`}\r\n        onDragEnter={handleDrag}\r\n        onDragLeave={handleDrag}\r\n        onDragOver={handleDrag}\r\n        onDrop={handleDrop}\r\n      >\r\n        <div className=\"upload-content\">\r\n          <div className=\"upload-icon\">üìÅ</div>\r\n          <h3>Upload Media</h3>\r\n          <p>Drag and drop files here, or click to select</p>\r\n          <input\r\n            type=\"file\"\r\n            accept=\"image/*,video/*,.glb\"\r\n            onChange={handleFileSelect}\r\n            disabled={uploading}\r\n            style={{ display: 'none' }}\r\n            id=\"media-upload\"\r\n          />\r\n          <label htmlFor=\"media-upload\" className=\"upload-button\">\r\n            {uploading ? 'Uploading...' : 'Choose File'}\r\n          </label>\r\n          {uploading && (\r\n            <div className=\"upload-progress\">\r\n              <div className=\"progress-bar\">\r\n                <div \r\n                  className=\"progress-fill\" \r\n                  style={{ width: `${uploadProgress}%` }}\r\n                ></div>\r\n              </div>\r\n              <span>{uploadProgress}%</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {error && <div className=\"error-message\">{error}</div>}\r\n\r\n      <div className=\"upload-info\">\r\n        <h4>Supported file types:</h4>\r\n        <ul>\r\n          <li>Images: JPEG, PNG, WebP</li>\r\n          <li>Videos: MP4</li>\r\n          <li>3D Models: GLB</li>\r\n        </ul>\r\n        <p>Maximum file size: 50MB</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MediaUploader;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}